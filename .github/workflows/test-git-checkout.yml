name: Git Checkout repository manually - test

on:
  push:
    branches: 
      - master

jobs:
  git-clone-repository:
    runs-on: ubuntu-latest

    # the following are JOB level/scope environment variables
    env:
      DOCKERHUB_IMAGE: simple-nginx
      # If DOCKERHUB_USERNAME is setup in github secrets, 
      #   then local DOCKERHUB_USERNAME can also set as:
      # DOCKERHUB_USERNAME: ${{ secrets.DOCKERHUB_USERNAME }}
      DOCKERHUB_USERNAME: kamranazeem
      # The DOCKER_CLI_EXPERIMENTAL needs to exist at job level,
      #   because it is needed in two separate steps.
      DOCKER_CLI_EXPERIMENTAL: enabled

    steps:
    - name: Checkout code - manually
      # uses: actions/checkout@v2
      run: |
        git clone ${GITHUB_REPOSITORY}
        pwd
        ls -l
        cd ${GITHUB_WORKSPACE}
        pwd
        ls -l

    - name: Setup correct SHORT_x variables
      id: prep
      run: |
        # The SHORT_REF and SHORT_HASH cannot be defined at job level,
        #   because they only exist **after** the code is checked out. 
        SHORT_REF=$(basename ${GITHUB_REF})
        SHORT_HASH=${GITHUB_SHA::7}
